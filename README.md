# üìä Telegram Analytics Bot (Text-to-SQL)

–¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤–∏–¥–µ–æ-–∫–æ–Ω—Ç–µ–Ω—Ç–∞. –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –≤ SQL-–∑–∞–ø—Ä–æ—Å—ã –∫ PostgreSQL —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LLM (Mistral AI).

–í—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏ Backend Developer.

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

*   **–Ø–∑—ã–∫:** Python 3.12
*   **–ë–æ—Ç:** aiogram 3.x
*   **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL 15
*   **–î—Ä–∞–π–≤–µ—Ä –ë–î:** asyncpg (–ø–æ–ª–Ω–æ—Å—Ç—å—é –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Å—Ç–µ–∫)
*   **LLM:** Mistral AI (API)
*   **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:** Docker & Docker Compose
*   **ETL:** –ü–æ—Ç–æ–∫–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ JSON (ijson)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Docker)

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –≤–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π [Docker](https://docs.docker.com/get-docker/) –∏ [Docker Compose](https://docs.docker.com/compose/install/).

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

### 2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
–°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ (`videos.json`) –ø–æ —Å—Å—ã–ª–∫–µ –∏–∑ –∑–∞–¥–∞–Ω–∏—è –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –µ–≥–æ –≤ –ø–∞–ø–∫—É `data/`:
```
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ç–∞–∫–æ–π:
repo/
‚îî‚îÄ‚îÄ data/
    ‚îî‚îÄ‚îÄ videos.json
```
*(–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: —Ñ–∞–π–ª –¥–∞–Ω–Ω—ã—Ö –∏—Å–∫–ª—é—á–µ–Ω –∏–∑ git, –µ–≥–æ –Ω—É–∂–Ω–æ —Å–∫–∞—á–∞—Ç—å –≤—Ä—É—á–Ω—É—é)*

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞. –í—ã –º–æ–∂–µ—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –Ω–∏–∂–µ –ø—Ä–∏–º–µ—Ä:
```
.env
–¢–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ Telegram-–±–æ—Ç–∞ (–ø–æ–ª—É—á–∏—Ç—å —É @BotFather)
TELEGRAM_BOT_TOKEN=123456789:ABCDefGhIjkLmNoPqRsTuVwXyZ

API –∫–ª—é—á –¥–ª—è Mistral AI (LLM)
–ü–æ–ª—É—á–∏—Ç—å –º–æ–∂–Ω–æ –Ω–∞ https://console.mistral.ai/
MISTRAL_API_KEY=–≤–∞—à_–∫–ª—é—á_mistral_api

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Mistral —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, OpenRouter), —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏ —É–∫–∞–∂–∏—Ç–µ URL:
MISTRAL_BASE_URL=https://api.openrouter.ai/v1
–ù–∞—Å—Ç—Ä–æ–π–∫–∏ PostgreSQL (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è Docker)
POSTGRES_USER=user
POSTGRES_PASSWORD=pass
POSTGRES_DB=analytics_db
POSTGRES_HOST=db
POSTGRES_PORT=5432
```
### 4. –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞
–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–±–æ—Ä–∫—É –∏ —Å—Ç–∞—Ä—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:
```
docker-compose up --build -d
```
**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞:**
1.  –ü–æ–¥–Ω–∏–º—É—Ç—Å—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (`db`) –∏ –±–æ—Ç–∞ (`bot`).
2.  –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç, –ø—É—Å—Ç–∞—è –ª–∏ –±–∞–∑–∞.
3.  –ï—Å–ª–∏ –±–∞–∑–∞ –ø—É—Å—Ç–∞—è, –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è ETL-–ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ `data/videos.json`.
    *   *–ó–∞–≥—Ä—É–∑–∫–∞ 18MB JSON –∑–∞–Ω–∏–º–∞–µ—Ç –æ–∫–æ–ª–æ 10-30 —Å–µ–∫—É–Ω–¥.*
4.  –ö–∞–∫ —Ç–æ–ª—å–∫–æ –≤ –ª–æ–≥–∞—Ö –ø–æ—è–≤–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ `–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!`, –±–æ—Ç –≥–æ—Ç–æ–≤ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã.

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
–ß—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –≤–∏–¥–µ—Ç—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã:
```
docker-compose logs -f bot
```

### 6. –û—Å—Ç–∞–Ω–æ–≤–∫–∞
```
docker-compose down
```